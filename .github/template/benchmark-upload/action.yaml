name: benchmark-upload
description: "Finish processing single benchmark report"

# Were we can define the inputs that our action will accept
inputs:
  report-path:
    required: true
    description: "Path of the report file to import"
  github-token:
    required: true
    description: "Github token"
  name:
    required: true
    description: "Benchmark name"

runs:
  using: "composite"
  steps:
    - uses: rhysd/github-action-benchmark@v1
      if: github.ref == 'refs/heads/main'
      with:
        tool: 'benchmarkdotnet'
        output-file-path: ${{ inputs.report-path }}
        alert-threshold: '200%'
        comment-on-alert: false
        comment-always: false
        fail-on-alert: false
        auto-push: true
        github-token: ${{ inputs.github-token }}
        benchmark-data-dir-path: ""
        name: ${{ inputs.name }}
    - uses: rhysd/github-action-benchmark@v1
      if: github.ref != 'refs/heads/main'
      with:
        tool: 'benchmarkdotnet'
        output-file-path: ${{ inputs.report-path }}
        alert-threshold: '200%'
        comment-on-alert: true
        comment-always: true
        fail-on-alert: true
        auto-push: false
        github-token: ${{ inputs.github-token }}
        benchmark-data-dir-path: ""
        name: ${{ inputs.name }}
